<!DOCTYPE html>
<html id="html" class="html">
  <head lang="en_GB">
  <meta charset="utf-8" />
  <title data-react-helmet="true">Making Maven Grunt - Windows Edition - Brendan Graetz</title>
  <meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/><meta data-react-helmet="true" name="og:ttl" content="600"/><meta data-react-helmet="true" name="og:site_name" content="Brendan Graetz"/><meta data-react-helmet="true" name="og:description" content="The blog that Brendan writes"/><meta data-react-helmet="true" name="og:locale" content="en_GB"/><meta data-react-helmet="true" name="og:title" content="Making Maven Grunt - Windows Edition - Brendan Graetz"/><meta data-react-helmet="true" name="og:url" content="http://blog.bguiz.com/2014/03/17/making-maven-grunt-windows-edition/"/><meta data-react-helmet="true" name="og:image" content="http://blog.bguiz.com/images/logo-400px.png"/><meta data-react-helmet="true" name="og:type" content="article"/>
  <link data-react-helmet="true" rel="canonical" content="http://blog.bguiz.com/2014/03/17/making-maven-grunt-windows-edition/"/>
</head>
  <body>
    <div id="outlet" class="outlet">
      <div id="root-page" class="root-page"><noscript></noscript><div id="navbar" class="navbar__navbar___3unxB"><ul id="navbar-list" class="navbar__navbar-list___33l7N"><li class="navbar__navbar-item___bZsgu"><a class="fa fa-home" title="Brendan Graetz" href="/"></a></li><li class="navbar__navbar-item___bZsgu"><a class="fa fa-files-o" title="Archives" href="/archives"></a></li><li class="navbar__navbar-item___bZsgu"><a class="fa fa-television" title="Presentations" href="/presentations"></a></li><li class="navbar__navbar-item___bZsgu"><a class="fa fa-book" title="Books" href="/books"></a></li><li class="navbar__navbar-item___bZsgu"><a href="https://twitter.com/bguiz" class="fa fa-twitter" title="@bguiz on Twitter"></a></li><li class="navbar__navbar-item___bZsgu"><a href="https://github.com/bguiz" class="fa fa-github" title="bguiz on github"></a></li><li class="navbar__navbar-item___bZsgu"><a href="http://stackoverflow.com/users/194982/bguiz" class="fa fa-stack-overflow" title="bguiz on stackoverflow"></a></li><li class="navbar__navbar-item___bZsgu"><a href="http://linkedin.com/in/brendangraetz/" class="fa fa-linkedin" title="Brendan Graetz on LinkedIn"></a></li><li class="navbar__navbar-item___bZsgu"><a href="http://reddit.com/u/bguiz" class="fa fa-reddit-alien" title="/u/bguiz on Reddit"></a></li><li class="navbar__navbar-item___bZsgu"><a href="https://plus.google.com/112370545733832378774?rel=author" class="fa fa-google-plus" title="@bguiz on Google+"></a></li></ul></div><div id="root-content" class="root-content"><div id="page-post" class="page page-post"><noscript></noscript><h1 id="page-title" class="page-title post-page__page-title___2KPKG">Making Maven Grunt - Windows Edition</h1><div id="page-body" class="page-body"><div class="post-page__post-date___3HkPG">2014/03/17</div><span class="markdown__markdown-render___9BIqe"><p>Recently, I needed to make a single-page web app that would be served by a Java backend.
That would be as simple as copying the static files into the relevant folder, right?
Well, as it turns out, not quite,
as each project used a different build system.</p>

<p>Single-page web apps are typically built using the Grunt and Bower toolchain,
which are NodeJs scripts.
Java backends are typically built using either the Ant or Maven toolchains.</p>

<h2>
<a name="pick-one-or-make-a-bridge" class="anchor" href="#pick-one-or-make-a-bridge" rel="noreferrer" target="_blank"><span class="octicon octicon-link"></span></a>Pick one, or make a bridge?</h2>

<p>So, should we replace the build tool of with the build tool of the other,
or should we just make one of them talk to the other?
Addy Osmani has an article, <a href="http://addyosmani.com/blog/making-maven-grunt/" rel="noreferrer" target="_blank">Making Maven Grunt</a>,
whichdescribes this situation quite succinctly:</p>

<p>“More times than not, it&#8217;s the back-end team who will define the build process and end up having to wrangle your front-end code into there.”</p>

<p>“Whilst there are many plugin options for JavaScript processing in the Maven world, these plugins can be a real chore to create, maintain and update. In addition, they often have outdated dependencies – meaning you need to monkey-patch them to work and developers – especially those not coming from a Java background – dislike it.”</p>

<p>Thus it appears that in order to get the best of both worlds,
the best option would be to create the bridge that allows one build system to talk to the other.
In this case, to make maven invoke grunt.</p>

<h2>
<a name="the-options" class="anchor" href="#the-options" rel="noreferrer" target="_blank"><span class="octicon octicon-link"></span></a>The options</h2>

<p>Turns out that this is a problem that several have had, and solved, before.</p>

<p><ul><li><a href="https://github.com/trecloux/yeoman-maven-plugin" rel="noreferrer" target="_blank">yeoman-maven-plugin</a></li></p>
<p><li>maven-antrun-plugin</li></p>
<p><li>exec-maven-plugin</li>
</ul><p>If you your web app is generated by <a href="http://yeoman.io" rel="noreferrer" target="_blank">yeoman</a>,
then the <code>yeoman-maven-plugin</code> provides some sensible configurations that work out of the box.
However, if you need something a little more flexible,
the <code>maven-antrun-plugin</code>, or the <code>exec-maven-plugin</code> is your best bet.</p></p>
<p>However, I did not want to throw Ant into the mix, 
as I was already using two other build systems,
and their syntaxes - 
and thus reluctant to throw a third syntax into the mix;
thus <code>exec-maven-plugin</code> it was!</p>

<h2>
<a name="why-dont-my-plugins-run" class="anchor" href="#why-dont-my-plugins-run" rel="noreferrer" target="_blank"><span class="octicon octicon-link"></span></a>Why don&#8217;t my plugins run?</h2>

<p>I asked a question on Stackoverflow:
<a href="http://stackoverflow.com/q/22392669/194982" rel="noreferrer" target="_blank">“Maven exec-maven-plugin and maven-resources-plugin not running, not sure why”</a></p>

<p>Excuse the newbie question on this one -
this was my first time using maven after all!</p>

<p>When including a maven plugin,
you define a list of <code>&lt;executions&gt;</code>.
I thought that defining a <code>&lt;phase&gt;</code> for each <code>&lt;execution&gt;</code> was sufficient to trigger them.
I learnt that it simply was not.
It is necessary to define at least one <code>&lt;goal&gt;</code> for the plugin to get invoked.</p>

<h2>
<a name="why-cant-my-plugin-find-executables" class="anchor" href="#why-cant-my-plugin-find-executables" rel="noreferrer" target="_blank"><span class="octicon octicon-link"></span></a>Why can&#8217;t my plugin find executables?</h2>

<p>A follow up question, also on Stackoverflow:
<a href="http://stackoverflow.com/q/22393785/194982" rel="noreferrer" target="_blank">exec-maven-plugin says cannot run specified program, even though it is on the PATH</a></p>

<p>Now this one was not a newbie question at all - it turned out to be a Windows-specific bug.</p>

<p>Basically, even though entering <code>grunt</code> on the command line worked, 
as it was on the path, when the maven plugin ran,
it failed to find it, much to my puzzlement.</p>

<p>After much tinkering, and inspecting the source code of <code>exec-maven-plugin</code>,
I found what I think is a bug in the plugin:</p>

<pre><code>    CommandLine toRet;
    if ( OS.isFamilyWindows() &amp;&amp; exec.toLowerCase( Locale.getDefault() ).endsWith( ".bat" ) )
    {
        toRet = new CommandLine( "cmd" );
        toRet.addArgument( "/c" );
        toRet.addArgument( exec );
    }
    else
    {
        toRet = new CommandLine( exec );
    }
</code></pre>

<p>It assumes that only commands that invoke <code>.bat</code> files need to be prepended with <code>cmd /c</code>.</p>

<p>I checked the <code>npm</code> path, where the links to all the global installed NodeJs libraries are,
i.e. the ones installed using <code>npm install -g</code>,
and found that it had, for each,
a Unix shell script, with no extension,
and a Windows batch script, with a <code>.cmd</code> extension.</p>

<p><em>Fixing the problem</em></p>

<p>Normally I would have fixed the problem by patching the bug in <code>exec-maven-plugin</code>.
However, it was using a <code>svn</code> instead of <code>git</code>, and using <code>xircles</code> instead of <code>github</code>.
I was not new to Subversion, but had not used it before in the context of
a open source contributions.
Prior to <code>github</code> the way I contributed to open source projects was:</p>

<p><ul><li><code>svn diff &gt; bug-that-this-patch-should-fix.diff</code></li></p>
<p><li>Attach <code>bug-that-this-patch-should-fix.diff</code> to the issue tracker, forum, or email the maintainer of the project.</li>
</ul><p>I have since been spoilt by git&#8217;s cheap branching,
and the ease with which pull requests can be managed in github&#8217;s interface.</p></p>
<p>I did give it a go, nonetheless, but I the web interface took more than a minute to load (kid not!),
and that was all it took for me to start looking for another way to solve the problem.</p>

<p>A quick and easy way was to simply rename the <code>.cmd</code> files to <code>.bat</code> files,
since they were batch script files anyway,
and everything magically began working once more.</p>

<p>See <a href="http://stackoverflow.com/a/22395703/194982" rel="noreferrer" target="_blank">my answer</a> for a more detailed explanation.</p>

<h2>
<a name="rant-over" class="anchor" href="#rant-over" rel="noreferrer" target="_blank"><span class="octicon octicon-link"></span></a>Rant over</h2>

<p>That has been half rant, half description of my learning experience.
I must say, I wish that a rather simple task like this were a little easier.</p>

<p>Hopefully this helps anyone else trying to use maven with grunt, on Windows.</p></span></div><div id="page-footer" class="page-footer"><div class="share-buttons__share-buttons___3c-nq"><ul class="share-buttons__share-items___35ozf"><li class="share-buttons__share-item___10u_7"><a href="mailto:?subject=Making Maven Grunt - Windows Edition - Brendan Graetz&amp;amp;body=http://blog.bguiz.com/2014/03/17/making-maven-grunt-windows-edition" class="share-buttons__share-button-email___3ktqW share-buttons__share-button___36_MO"><span class="fa fa-envelope"></span><div class="share-count"> </div></a></li><li class="share-buttons__share-item___10u_7"><div role="button" tabindex="0" class="SocialMediaShareButton SocialMediaShareButton--facebook share-buttons__share-button-facebook___uSKF_ share-buttons__share-button___36_MO"><span class="fa fa-facebook"></span><div class="SocialMediaShareCount share-count"><span class="share-count-inner">&nbsp;</span></div></div></li><li class="share-buttons__share-item___10u_7"><div role="button" tabindex="0" class="SocialMediaShareButton SocialMediaShareButton--twitter share-buttons__share-button-twitter___3vZWS share-buttons__share-button___36_MO"><span class="fa fa-twitter"></span><div class="share-count"> </div></div></li><li class="share-buttons__share-item___10u_7"><div role="button" tabindex="0" class="SocialMediaShareButton SocialMediaShareButton--googlePlus share-buttons__share-button-google-plus___1OUuW share-buttons__share-button___36_MO"><span class="fa fa-google-plus"></span><div class="SocialMediaShareCount share-count"><span class="share-count-inner">&nbsp;</span></div></div></li><li class="share-buttons__share-item___10u_7"><div role="button" tabindex="0" class="SocialMediaShareButton SocialMediaShareButton--linkedin share-buttons__share-button-linkedin___2EwnF share-buttons__share-button___36_MO"><span class="fa fa-linkedin"></span><div class="SocialMediaShareCount share-count"><span class="share-count-inner">&nbsp;</span></div></div></li></ul></div><div><span>Tagged in:</span><ul class="post-tags__tags-list___3m4XD"><li class="post-tags__tags-item___3xlEk"><a href="/tags/maven">maven</a></li><li class="post-tags__tags-item___3xlEk"><a href="/tags/maven pluign">maven pluign</a></li><li class="post-tags__tags-item___3xlEk"><a href="/tags/grunt">grunt</a></li><li class="post-tags__tags-item___3xlEk"><a href="/tags/bower">bower</a></li><li class="post-tags__tags-item___3xlEk"><a href="/tags/windows">windows</a></li><li class="post-tags__tags-item___3xlEk"><a href="/tags/deployment">deployment</a></li><li class="post-tags__tags-item___3xlEk"><a href="/tags/blog">blog</a></li></ul></div><div><a href="https://github.com/bguiz/blog.bguiz.com/blob/develop/src/documents/tumblrposts/2014-03-17-making-maven-grunt-windows-edition.html" target="_blank">Edit this content</a></div><div><div title="Making Maven Grunt - Windows Edition"><div id="disqus_thread"></div><noscript><span>Please enable JavaScript to view the<a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by<span class="logo-disqus">Disqus</span></a></div></div></div></div></div><div id="footprofile" class="foot-profile__footprofile___23hoj"><div class="foot-profile__footprofile-logo___3JA-e"><img src="/images/logo-100px.png" alt="Brendan Graetz"/></div><div class="foot-profile__footprofile-links___3U9KR"><ul class="foot-profile__footer-links___2SYBF"><li class="foot-profile__footer-item___22yBd"><a title="Brendan Graetz" href="/"><span class="fa fa-home foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">Brendan Graetz</span></a></li><li class="foot-profile__footer-item___22yBd"><a title="Archives" href="/archives"><span class="fa fa-files-o foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">Archives</span></a></li><li class="foot-profile__footer-item___22yBd"><a title="Presentations" href="/presentations"><span class="fa fa-television foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">Presentations</span></a></li><li class="foot-profile__footer-item___22yBd"><a title="Books" href="/books"><span class="fa fa-book foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">Books</span></a></li><li class="foot-profile__footer-item___22yBd"><a href="https://twitter.com/bguiz" title="@bguiz on Twitter"><span class="fa fa-twitter foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">@bguiz</span></a></li><li class="foot-profile__footer-item___22yBd"><a href="https://github.com/bguiz" title="bguiz on github"><span class="fa fa-github foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">Github</span></a></li><li class="foot-profile__footer-item___22yBd"><a href="http://stackoverflow.com/users/194982/bguiz" title="bguiz on stackoverflow"><span class="fa fa-stack-overflow foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">Stackoverflow</span></a></li><li class="foot-profile__footer-item___22yBd"><a href="http://linkedin.com/in/brendangraetz/" title="Brendan Graetz on LinkedIn"><span class="fa fa-linkedin foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">LinkedIn</span></a></li><li class="foot-profile__footer-item___22yBd"><a href="http://reddit.com/u/bguiz" title="/u/bguiz on Reddit"><span class="fa fa-reddit-alien foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">Reddit</span></a></li><li class="foot-profile__footer-item___22yBd"><a href="https://plus.google.com/112370545733832378774?rel=author" title="@bguiz on Google+"><span class="fa fa-google-plus foot-profile__footer-link-icon___11CDs"></span><span class="foot-profile__footer-link-text___1slED">+bguiz.com</span></a></li></ul></div><div class="foot-profile__clear___1vNYP"></div></div><div id="footbar" class="footbar__footbar___2dhrz"><p class="footbar__footbar-text___Rc4dT">Copyright © 2008-present Brendan Graetz</p></div></div>
    </div>
    
<link rel="stylesheet" type="text/css" href="/app.css">
<link rel="stylesheet" type="text/css" href="/3rd-party/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="/3rd-party/highlight-js/css/dracula.css">
<script type="text/javascript" src="/bundle.js"></script>
  </body>
</html>